<!DOCTYPE html>
<!-- saved from url=(0059)file:///C:/Users/Usu%C3%A1rio/Desktop/cartolaanalisyai.html -->
<html lang="pt-BR">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
        min-height: 100vh;
        color: #fff;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
      }

      header {
        text-align: center;
        padding: 40px 20px;
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(0, 0, 0, 0.3) 100%);
        border-radius: 20px;
        margin-bottom: 30px;
        border: 2px solid rgba(255, 215, 0, 0.3);
        position: relative;
        overflow: hidden;
      }

      header::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
        animation: pulse 4s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.5;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.8;
        }
      }

      h1 {
        font-size: 3em;
        margin-bottom: 10px;
        background: linear-gradient(45deg, #ffd700, #ffed4e, #ffd700);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        position: relative;
        z-index: 1;
      }

      .subtitle {
        font-size: 1.3em;
        opacity: 0.9;
        color: #a8d8ff;
        position: relative;
        z-index: 1;
      }

      .formation-badge {
        display: inline-block;
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        padding: 8px 20px;
        border-radius: 25px;
        font-weight: bold;
        margin-top: 15px;
        font-size: 1.2em;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .control-panel {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        align-items: end;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      label {
        font-weight: 600;
        color: #ffd700;
        font-size: 0.9em;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      input,
      select {
        padding: 14px 18px;
        border: 2px solid rgba(255, 215, 0, 0.3);
        border-radius: 12px;
        background: rgba(0, 0, 0, 0.3);
        color: #fff;
        font-size: 1em;
        transition: all 0.3s;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: #ffd700;
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
      }

      button {
        padding: 18px 40px;
        background: linear-gradient(45deg, #ffd700, #ffed4e);
        color: #1a1a2e;
        border: none;
        border-radius: 12px;
        font-size: 1.2em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 2px;
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .loading {
        text-align: center;
        padding: 60px 20px;
      }

      .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(255, 215, 0, 0.3);
        border-top: 4px solid #ffd700;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .analysis-steps {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .step {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px 25px;
        border-radius: 30px;
        font-size: 0.9em;
        opacity: 0.6;
        transition: all 0.3s;
      }

      .step.active {
        opacity: 1;
        background: rgba(255, 215, 0, 0.2);
        border: 1px solid #ffd700;
        transform: scale(1.05);
      }

      .main-content {
        display: none;
        gap: 30px;
      }

      .field-section {
        flex: 1;
      }

      .field-container {
        background: linear-gradient(180deg, #2d5a27 0%, #1e3c1b 100%);
        border-radius: 20px;
        padding: 40px;
        position: relative;
        border: 3px solid rgba(255, 255, 255, 0.2);
        box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.5);
        min-height: 800px;
      }

      .field-lines {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        height: 90%;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        pointer-events: none;
      }

      .center-line {
        position: absolute;
        top: 0;
        left: 50%;
        width: 3px;
        height: 100%;
        background: rgba(255, 255, 255, 0.3);
        transform: translateX(-50%);
      }

      .center-circle {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 150px;
        height: 150px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
      }

      .penalty-area-top,
      .penalty-area-bottom {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: 40%;
        height: 15%;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 0 0 50% 50%;
      }

      .penalty-area-top {
        top: 0;
        border-radius: 0 0 50% 50%;
      }

      .penalty-area-bottom {
        bottom: 0;
        border-radius: 50% 50% 0 0;
      }

      .team-formation {
        position: relative;
        z-index: 10;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 20px 0;
      }

      .position-row {
        display: flex;
        justify-content: center;
        gap: 40px;
        flex-wrap: wrap;
      }

      .player-position {
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(30, 30, 30, 0.9) 100%);
        border: 2px solid #ffd700;
        border-radius: 15px;
        padding: 15px;
        text-align: center;
        min-width: 140px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transition: all 0.3s;
        cursor: pointer;
      }

      .player-position:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3);
      }

      .player-position.selected {
        border-color: #00ff88;
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
      }

      .pos-label {
        font-size: 0.75em;
        color: #ffd700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
        font-weight: bold;
      }

      .player-badge {
        width: 50px;
        height: 50px;
        margin: 0 auto 10px;
        border-radius: 50%;
        overflow: hidden;
        border: 3px solid #fff;
        background: #fff;
      }

      .player-badge img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .player-name-field {
        font-weight: bold;
        font-size: 0.9em;
        margin-bottom: 5px;
        color: #fff;
      }

      .player-team-field {
        font-size: 0.75em;
        color: #aaa;
      }

      .player-price-field {
        background: #ffd700;
        color: #000;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: bold;
        display: inline-block;
        margin-top: 5px;
      }

      .analysis-section {
        width: 100%;
        max-width: 500px;
      }

      .matchups-panel {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 25px;
        margin-bottom: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .panel-title {
        font-size: 1.4em;
        color: #ffd700;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .matchup-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .matchup-item {
        background: rgba(0, 0, 0, 0.3);
        padding: 15px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-left: 4px solid #ffd700;
      }

      .matchup-teams {
        display: flex;
        align-items: center;
        gap: 15px;
        flex: 1;
      }

      .matchup-team {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .matchup-team img {
        width: 30px;
        height: 30px;
        object-fit: contain;
      }

      .vs {
        font-weight: bold;
        color: #ffd700;
        font-size: 0.9em;
      }

      .matchup-difficulty {
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.75em;
        font-weight: bold;
      }

      .difficulty-easy {
        background: #28a745;
        color: white;
      }
      .difficulty-medium {
        background: #ffc107;
        color: #000;
      }
      .difficulty-hard {
        background: #dc3545;
        color: white;
      }

      .justification-panel {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 25px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .justification-content {
        margin-top: 20px;
      }

      .justification-card {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(0, 0, 0, 0.3) 100%);
        border-left: 4px solid #ffd700;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 15px;
        display: none;
      }

      .justification-card.active {
        display: block;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .justification-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
      }

      .justification-header img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #fff;
        padding: 3px;
      }

      .justification-title {
        font-size: 1.2em;
        color: #ffd700;
        font-weight: bold;
      }

      .justification-text {
        line-height: 1.6;
        color: #e0e0e0;
        font-size: 0.95em;
      }

      .ai-reasoning {
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid rgba(0, 255, 136, 0.3);
        padding: 15px;
        border-radius: 10px;
        margin-top: 15px;
      }

      .ai-reasoning-title {
        color: #00ff88;
        font-weight: bold;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-top: 15px;
      }

      .stat-item {
        background: rgba(0, 0, 0, 0.3);
        padding: 10px;
        border-radius: 8px;
        text-align: center;
      }

      .stat-value {
        font-size: 1.3em;
        font-weight: bold;
        color: #ffd700;
      }

      .stat-label {
        font-size: 0.75em;
        color: #aaa;
        margin-top: 3px;
      }

      .summary-panel {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(0, 0, 0, 0.3) 100%);
        border: 2px solid rgba(255, 215, 0, 0.3);
        border-radius: 20px;
        padding: 30px;
        margin-top: 30px;
        text-align: center;
      }

      .summary-title {
        font-size: 1.8em;
        color: #ffd700;
        margin-bottom: 20px;
      }

      .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .summary-stat {
        background: rgba(0, 0, 0, 0.4);
        padding: 20px;
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .summary-value {
        font-size: 2.5em;
        font-weight: bold;
        color: #ffd700;
      }

      .summary-label {
        color: #aaa;
        margin-top: 5px;
        font-size: 0.9em;
      }

      .tactical-note {
        background: rgba(0, 123, 255, 0.1);
        border-left: 4px solid #007bff;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        text-align: left;
      }

      .tactical-note h4 {
        color: #007bff;
        margin-bottom: 10px;
      }

      @media (max-width: 1200px) {
        .main-content {
          flex-direction: column;
        }

        .analysis-section {
          max-width: 100%;
        }

        .field-container {
          min-height: 600px;
        }
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2em;
        }
        .position-row {
          gap: 15px;
        }
        .player-position {
          min-width: 100px;
          padding: 10px;
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>‚öΩ Cartola FC AI Pro</h1>
        <p class="subtitle">An√°lise T√°tica Completa com Justificativas da IA</p>
        <div class="formation-badge">ESQUEMA 4-3-3</div>
      </header>

      <div class="control-panel">
        <div class="input-group">
          <label for="budget">üí∞ Seu Patrim√¥nio (C$)</label>
          <input type="number" id="budget" placeholder="Ex: 100.0" value="100.0" step="0.1" />
        </div>

        <div class="input-group">
          <label for="rodada">üìÖ Rodada</label>
          <select id="rodada">
            <option value="current">Rodada Atual</option>
            <option value="4">Rodada 4</option>
            <option value="5">Rodada 5</option>
            <option value="6">Rodada 6</option>
          </select>
        </div>

        <div class="input-group">
          <label for="strategy">üéØ Estrat√©gia IA</label>
          <select id="strategy">
            <option value="balanced">Balanceada (Recomendado)</option>
            <option value="aggressive">Agressiva (Pontua√ß√£o M√°xima)</option>
            <option value="defensive">Defensiva (Jogos F√°ceis)</option>
            <option value="value">Custo-Benef√≠cio</option>
          </select>
        </div>

        <button id="analyzeBtn">üîç MONTAR TIME COM IA</button>
      </div>

      <div id="loadingSection" class="loading" style="display: none">
        <div class="spinner"></div>
        <h3>Analisando dados com Intelig√™ncia Artificial...</h3>
        <div class="analysis-steps">
          <div class="step" id="step1">üìä Buscando Estat√≠sticas</div>
          <div class="step" id="step2">‚öîÔ∏è Analisando Confrontos</div>
          <div class="step" id="step3">üß† Calculando Probabilidades</div>
          <div class="step active" id="step4">‚úÖ Montando Time Ideal</div>
        </div>
      </div>

      <div id="mainContent" class="main-content" style="display: flex">
        <div class="field-section">
          <div class="field-container">
            <div class="field-lines">
              <div class="center-line"></div>
              <div class="center-circle"></div>
              <div class="penalty-area-top"></div>
              <div class="penalty-area-bottom"></div>
            </div>

            <div class="team-formation" id="teamFormation">
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">T√©cnico</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60.png" alt="COR" />
                  </div>
                  <div class="player-name-field">Dorival J√∫nior</div>
                  <div class="player-team-field">COR</div>
                  <div class="player-price-field">C$ 12.29</div>
                </div>
              </div>
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">Atacante 1</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(1).png" alt="GRE" />
                  </div>
                  <div class="player-name-field">Carlos Vin√≠cius</div>
                  <div class="player-team-field">GRE</div>
                  <div class="player-price-field">C$ 18.60</div>
                </div>
                <div class="player-position">
                  <div class="pos-label">Atacante 2</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(2).png" alt="REM" />
                  </div>
                  <div class="player-name-field">Alef Manga</div>
                  <div class="player-team-field">REM</div>
                  <div class="player-price-field">C$ 9.01</div>
                </div>
                <div class="player-position">
                  <div class="pos-label">Atacante 3</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(3).png" alt="CAP" />
                  </div>
                  <div class="player-name-field">Viveros</div>
                  <div class="player-team-field">CAP</div>
                  <div class="player-price-field">C$ 11.56</div>
                </div>
              </div>
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">Meia 1</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60.png" alt="COR" />
                  </div>
                  <div class="player-name-field">Breno Bidon</div>
                  <div class="player-team-field">COR</div>
                  <div class="player-price-field">C$ 13.34</div>
                </div>
                <div class="player-position">
                  <div class="pos-label">Meia 2</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(4).png" alt="SAN" />
                  </div>
                  <div class="player-name-field">Thaciano</div>
                  <div class="player-team-field">SAN</div>
                  <div class="player-price-field">C$ 8.81</div>
                </div>
                <div class="player-position selected">
                  <div class="pos-label">Meia 3</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(5).png" alt="PAL" />
                  </div>
                  <div class="player-name-field">Andreas Pereira</div>
                  <div class="player-team-field">PAL</div>
                  <div class="player-price-field">C$ 17.92</div>
                </div>
              </div>
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">Zagueiro 1</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(1).png" alt="GRE" />
                  </div>
                  <div class="player-name-field">Noriega</div>
                  <div class="player-team-field">GRE</div>
                  <div class="player-price-field">C$ 6.43</div>
                </div>
                <div class="player-position">
                  <div class="pos-label">Zagueiro 2</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(2).png" alt="REM" />
                  </div>
                  <div class="player-name-field">Marllon</div>
                  <div class="player-team-field">REM</div>
                  <div class="player-price-field">C$ 5.99</div>
                </div>
              </div>
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">Lateral 1</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(6).png" alt="RBB" />
                  </div>
                  <div class="player-name-field">Juninho Capixaba</div>
                  <div class="player-team-field">RBB</div>
                  <div class="player-price-field">C$ 12.85</div>
                </div>
                <div class="player-position">
                  <div class="pos-label">Lateral 2</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(4).png" alt="SAN" />
                  </div>
                  <div class="player-name-field">Igor Vin√≠cius</div>
                  <div class="player-team-field">SAN</div>
                  <div class="player-price-field">C$ 7.63</div>
                </div>
              </div>
              <div class="position-row">
                <div class="player-position">
                  <div class="pos-label">Goleiro</div>
                  <div class="player-badge">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60.png" alt="COR" />
                  </div>
                  <div class="player-name-field">Hugo Souza</div>
                  <div class="player-team-field">COR</div>
                  <div class="player-price-field">C$ 12.97</div>
                </div>
              </div>
            </div>
          </div>

          <div class="summary-panel">
            <div class="summary-title">üìä Resumo da An√°lise IA</div>
            <div class="summary-stats">
              <div class="summary-stat">
                <div class="summary-value" id="totalCost">C$ 137.40</div>
                <div class="summary-label">Custo Total</div>
              </div>
              <div class="summary-stat">
                <div class="summary-value" id="remainingBudget">C$ 42.60</div>
                <div class="summary-label">Saldo</div>
              </div>
              <div class="summary-stat">
                <div class="summary-value" id="projectedPoints">110.29</div>
                <div class="summary-label">Pontos Estimados</div>
              </div>
              <div class="summary-stat">
                <div class="summary-value" id="avgCostBenefit">0.80</div>
                <div class="summary-label">Custo/Benef√≠cio M√©dio</div>
              </div>
            </div>

            <div class="tactical-note">
              <h4>üìù An√°lise T√°tica da IA</h4>
              <p id="tacticalAnalysis">
                <strong>An√°lise T√°tica 4-3-3:</strong><br /><br />‚Ä¢
                <strong>8 jogadores</strong> atuam em casa, favorecendo desempenho.<br />‚Ä¢
                <strong>9 confrontos f√°ceis</strong> identificados pela IA para maximizar pontua√ß√£o.<br />‚Ä¢
                <strong>Defesa s√≥lida:</strong> Goleiro com chance alta de SG (Clean Sheet).<br />‚Ä¢
                <strong>Ataque potente:</strong> Carlos Vin√≠cius √© o principal finalizador com m√©dia de 12.27 pts.<br /><br /><em>Time
                  montado com estrat√©gia otimizada para pontuar dentro do or√ßamento dispon√≠vel.</em>
              </p>
            </div>
          </div>
        </div>

        <div class="analysis-section">
          <div class="matchups-panel">
            <div class="panel-title">‚öîÔ∏è Confrontos da Rodada</div>
            <div class="matchup-list" id="matchupList">
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30.png" alt="RBB" />
                    <span>RBB</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(1).png" alt="CAP" />
                    <span>CAP</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-medium">7¬∫</span>
                  <span class="matchup-difficulty difficulty-medium">6¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(2).png" alt="REM" />
                    <span>REM</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(3).png" alt="INT" />
                    <span>INT</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-easy">16¬∫</span>
                  <span class="matchup-difficulty difficulty-easy">18¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(4).png" alt="CRU" />
                    <span>CRU</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(5).png" alt="COR" />
                    <span>COR</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-easy">19¬∫</span>
                  <span class="matchup-difficulty difficulty-hard">3¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(6).png" alt="PAL" />
                    <span>PAL</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(7).png" alt="FLU" />
                    <span>FLU</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-hard">1¬∫</span>
                  <span class="matchup-difficulty difficulty-hard">5¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(8).png" alt="GRE" />
                    <span>GRE</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(9).png" alt="CAM" />
                    <span>CAM</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-medium">8¬∫</span>
                  <span class="matchup-difficulty difficulty-easy">17¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(10).png" alt="SAN" />
                    <span>SAN</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(11).png" alt="VAS" />
                    <span>VAS</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-medium">13¬∫</span>
                  <span class="matchup-difficulty difficulty-easy">20¬∫</span>
                </div>
              </div>
              <div class="matchup-item">
                <div class="matchup-teams">
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(12).png" alt="CFC" />
                    <span>CFC</span>
                  </div>
                  <span class="vs">VS</span>
                  <div class="matchup-team">
                    <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/30x30(13).png" alt="SAO" />
                    <span>SAO</span>
                  </div>
                </div>
                <div style="display: flex; gap: 5px">
                  <span class="matchup-difficulty difficulty-medium">12¬∫</span>
                  <span class="matchup-difficulty difficulty-hard">2¬∫</span>
                </div>
              </div>
            </div>
          </div>

          <div class="justification-panel">
            <div class="panel-title">üß† Justificativas da IA</div>
            <p style="color: #aaa; font-size: 0.9em; margin-bottom: 15px">
              Clique em qualquer jogador no campo para ver a an√°lise detalhada
            </p>
            <div class="justification-content" id="justificationContent">
              <div class="justification-card active">
                <div class="justification-header">
                  <img src="./Cartola FC AI Pro - An√°lise T√°tica Completa 4-3-3_files/60x60(5).png" alt="PAL" />
                  <div>
                    <div class="justification-title">Andreas Pereira</div>
                    <div style="color: #aaa; font-size: 0.9em">Meia - PAL</div>
                  </div>
                </div>

                <div class="justification-text">
                  <p style="margin-bottom: 10px">
                    üî• <strong>Excelente m√©dia de 12.7 pontos</strong> - Entre os melhores da posi√ß√£o no Cartola.
                  </p>
                  <p style="margin-bottom: 10px">
                    ‚ö†Ô∏è <strong>Confronto desafiador</strong> - Enfrenta FLU (5¬∫), mas hist√≥rico recente compensa o risco.
                  </p>
                  <p style="margin-bottom: 10px">
                    ‚≠ê <strong>Cartilheiro premium (C$ 17.92)</strong> - Investimento alto mas com retorno garantido pela
                    qualidade.
                  </p>
                </div>

                <div class="ai-reasoning">
                  <div class="ai-reasoning-title">ü§ñ Score IA: 144.2 pts</div>
                  <div class="stats-grid">
                    <div class="stat-item">
                      <div class="stat-value">12.7</div>
                      <div class="stat-label">M√©dia</div>
                    </div>
                    <div class="stat-item">
                      <div class="stat-value">C$ 17.92</div>
                      <div class="stat-label">Pre√ßo</div>
                    </div>
                    <div class="stat-item">
                      <div class="stat-value">3</div>
                      <div class="stat-label">Jogos</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Adicionado um proxy para contornar poss√≠veis problemas de CORS com a API do Cartola FC
      // ATEN√á√ÉO: Este √© um proxy p√∫blico para TESTES. Para produ√ß√£o, considere hospedar seu pr√≥prio proxy.
      const PROXY_URL = "https://corsproxy.io/?";
      const API_BASE = "https://api.cartola.globo.com";

      let cachedData = {
        atletas: null,
        clubes: null,
        partidas: null,
        status: null,
      };

      let selectedTeam = {};

      const FORMATION_433 = {
        1: { row: 1, positions: [1] }, // GOL
        2: { row: 2, positions: [2, 2] }, // 2 LAT
        3: { row: 2, positions: [3, 3] }, // 2 ZAG
        4: { row: 3, positions: [4, 4, 4] }, // 3 MEI
        5: { row: 4, positions: [5, 5, 5] }, // 3 ATA
        6: { row: 5, positions: [6] }, // TEC
      };

      const POSITION_NAMES = {
        1: "Goleiro",
        2: "Lateral",
        3: "Zagueiro",
        4: "Meia",
        5: "Atacante",
        6: "T√©cnico",
      };

      async function fetchData() {
        try {
          const [statusRes, clubesRes, partidasRes] = await Promise.all([
            fetch(`${PROXY_URL}${encodeURIComponent(`${API_BASE}/mercado/status`)}`),
            fetch(`${PROXY_URL}${encodeURIComponent(`${API_BASE}/clubes`)}`),
            fetch(`${PROXY_URL}${encodeURIComponent(`${API_BASE}/partidas`)}`),
          ]);

          cachedData.status = await statusRes.json();
          cachedData.clubes = await clubesRes.json();
          cachedData.partidas = await partidasRes.json();

          try {
            const atletasRes = await fetch(`${PROXY_URL}${encodeURIComponent(`${API_BASE}/atletas/mercado`)}`);
            if (atletasRes.ok) {
              const data = await atletasRes.json();
              cachedData.atletas = data.atletas || data;
            } else {
              console.warn("Falha ao buscar atletas do mercado, gerando dados mock.");
              cachedData.atletas = generateMockAtletas();
            }
          } catch (e) {
            console.error("Erro ao buscar atletas do mercado, gerando dados mock:", e);
            cachedData.atletas = generateMockAtletas();
          }

          return true;
        } catch (error) {
          console.error("Erro geral ao carregar dados da API:", error);
          alert("Erro ao carregar dados da API. Verifique sua conex√£o ou tente novamente mais tarde.");
          return false;
        }
      }

      function generateMockAtletas() {
        const atletas = [];
        let id = 1;

        const nomesPorPosicao = {
          1: ["Weverton", "Everson", "Alisson", "Tadeu", "C√°ssio", "Rafael", "Jean"],
          2: ["Marcos Rocha", "Guilherme Arana", "Mayke", "Piquerez", "Vanderson", "Alex Telles"],
          3: ["Gustavo G√≥mez", "Murilo", "Jemerson", "L√©o Pereira", "David Luiz", "Fabricio Bruno"],
          4: ["Raphael Veiga", "Arrascaeta", "Gerson", "Tch√™ Tch√™", "Z√© Rafael", "Alan Patrick"],
          5: ["Endrick", "Estev√£o", "Luiz Henrique", "Yuri Alberto", "Hulk", "Pedro", "Gabigol"],
          6: ["Abel Ferreira", "Luiz Felipe Scolari", "Rog√©rio Ceni", "Renato Portaluppi", "Artur Jorge"],
        };

        // Certifica-se de que cachedData.clubes est√° populado antes de tentar us√°-lo
        // Se cachedData.clubes ainda for nulo, usa um fallback
        const clubesIds = cachedData.clubes
          ? Object.keys(cachedData.clubes).filter((id) => id !== "1")
          : ["1", "2", "3", "4", "5"]; // Fallback com IDs fict√≠cios

        Object.keys(nomesPorPosicao).forEach((posId) => {
          nomesPorPosicao[posId].forEach((nome) => {
            const clubeId = clubesIds[Math.floor(Math.random() * clubesIds.length)];
            const preco =
              posId === "6" ? (Math.random() * 8 + 4).toFixed(2) : (Math.random() * 12 + 4).toFixed(2);

            atletas.push({
              id: id++,
              apelido: nome,
              posicao_id: parseInt(posId),
              clube_id: parseInt(clubeId),
              preco_num: parseFloat(preco),
              media_num: (Math.random() * 7 + 3).toFixed(2),
              jogos_num: Math.floor(Math.random() * 4) + 1,
              status_id: 7, // 7 = Prov√°vel
              variacao_num: (Math.random() * 2 - 1).toFixed(2),
              minimo_para_valorizar: (Math.random() * 5 + 3).toFixed(1),
            });
          });
        });

        return atletas;
      }

      function getMatchAnalysis(clubeId, partidas) {
        if (!partidas || !partidas.partidas) return null;

        const match = partidas.partidas.find(
          (p) => p.clube_casa_id === clubeId || p.clube_visitante_id === clubeId
        );

        if (!match) return null;

        const isHome = match.clube_casa_id === clubeId;
        const opponentId = isHome ? match.clube_visitante_id : match.clube_casa_id;
        const opponentPos = isHome ? match.clube_visitante_posicao : match.clube_casa_posicao;
        const opponentName = cachedData.clubes[opponentId]?.nome || "Advers√°rio";

        let difficulty, difficultyClass, analysis;

        if (opponentPos <= 5) {
          difficulty = "Dif√≠cil";
          difficultyClass = "hard";
          analysis = `Confronto complicado contra ${opponentName} (${opponentPos}¬∫). Requer cautela.`;
        } else if (opponentPos >= 15) {
          difficulty = "F√°cil";
          difficultyClass = "easy";
          analysis = `Excelente confronto contra ${opponentName} (${opponentPos}¬∫). Grande chance de SG e pontua√ß√£o alta.`;
        } else {
          difficulty = "M√©dio";
          difficultyClass = "medium";
          analysis = `Confronto equilibrado contra ${opponentName} (${opponentPos}¬∫).`;
        }

        return {
          isHome,
          opponentId,
          opponentName,
          opponentPos,
          difficulty,
          difficultyClass,
          analysis,
          local: isHome ? "Casa" : "Fora",
        };
      }

      function calculateAIScore(player, matchInfo, strategy) {
        let score = 0;
        const media = parseFloat(player.media_num) || 0;
        const preco = parseFloat(player.preco_num) || 0;
        const variacao = parseFloat(player.variacao_num) || 0;
        const minimo = parseFloat(player.minimo_para_valorizar) || 0;

        // Base score
        score += media * 12;

        // Consistency
        if (player.jogos_num >= 3) score += 8;

        // Price trend (if rising, good sign)
        if (variacao > 0) score += variacao * 5;

        // Match difficulty
        if (matchInfo) {
          if (matchInfo.difficulty === "F√°cil") score += 15;
          else if (matchInfo.difficulty === "M√©dio") score += 5;
          else score -= 10;

          // Home advantage
          if (matchInfo.isHome) score += 5;
        }

        // Strategy specific
        switch (strategy) {
          case "aggressive":
            score += media * 3;
            score -= preco * 0.5;
            break;
          case "defensive":
            if (matchInfo?.difficulty === "F√°cil") score += 20;
            if (matchInfo?.difficulty === "Dif√≠cil") score -= 15;
            break;
          case "value":
            if (preco > 0) score += (media / preco) * 25;
            break;
          default:
            // balanced
            score += (media / (preco || 1)) * 15;
            score -= preco * 0.3;
        }

        // Position specific bonuses
        if (player.posicao_id === 1 && matchInfo?.difficulty === "F√°cil") score += 10; // GK clean sheet potential
        if (player.posicao_id === 5 && matchInfo?.difficulty === "F√°cil") score += 8; // Striker goal potential

        return {
          total: score,
          details: {
            mediaScore: media * 12,
            consistencyBonus: player.jogos_num >= 3 ? 8 : 0,
            matchBonus: matchInfo
              ? matchInfo.difficulty === "F√°cil"
                ? 15
                : matchInfo.difficulty === "M√©dio"
                ? 5
                : -10
              : 0,
            homeBonus: matchInfo?.isHome ? 5 : 0,
            strategyBonus: strategy === "value" ? (media / (preco || 1)) * 25 : 0,
          },
        };
      }

      function generateJustification(player, matchInfo, aiScore, strategy) {
        const justifications = [];
        const media = parseFloat(player.media_num);

        // Performance justification
        if (media >= 8) {
          justifications.push(
            `üî• <strong>Excelente m√©dia de ${media} pontos</strong> - Entre os melhores da posi√ß√£o no Cartola.`
          );
        } else if (media >= 5) {
          justifications.push(
            `üìà <strong>Boa m√©dia de ${media} pontos</strong> - Consist√™ncia comprovada nas √∫ltimas rodadas.`
          );
        } else {
          justifications.push(
            `üí° <strong>M√©dia de ${media} pontos</strong> - Potencial de valoriza√ß√£o com pre√ßo acess√≠vel.`
          );
        }

        // Match justification
        if (matchInfo) {
          if (matchInfo.difficulty === "F√°cil") {
            justifications.push(
              `üéØ <strong>Confronto favor√°vel</strong> - Joga ${matchInfo.local.toLowerCase()} contra ${
                matchInfo.opponentName
              } (${matchInfo.opponentPos}¬∫ colocado), grande chance de pontua√ß√£o alta.`
            );
          } else if (matchInfo.difficulty === "Dif√≠cil") {
            justifications.push(
              `‚ö†Ô∏è <strong>Confronto desafiador</strong> - Enfrenta ${matchInfo.opponentName} (${matchInfo.opponentPos}¬∫), mas hist√≥rico recente compensa o risco.`
            );
          } else {
            justifications.push(
              `‚öñÔ∏è <strong>Confronto equilibrado</strong> - Partida disputada contra ${
                matchInfo.opponentName
              }, mas jogando ${matchInfo.local.toLowerCase()} favorece.`
            );
          }
        }

        // Price justification
        const preco = parseFloat(player.preco_num);
        if (strategy === "value") {
          const ratio = (media / preco).toFixed(2);
          justifications.push(
            `üí∞ <strong>Excelente custo-benef√≠cio</strong> - Cada cartoleta rende ${ratio} pontos em m√©dia.`
          );
        } else if (preco < 8) {
          justifications.push(
            `üíé <strong>Pre√ßo acess√≠vel (C$ ${preco})</strong> - Permite investir em outras posi√ß√µes.`
          );
        } else if (preco > 12) {
          justifications.push(
            `‚≠ê <strong>Cartilheiro premium (C$ ${preco})</strong> - Investimento alto mas com retorno garantido pela qualidade.`
          );
        }

        // Specific position tips
        if (player.posicao_id === 1 && matchInfo?.difficulty === "F√°cil") {
          justifications.push(
            `üõ°Ô∏è <strong>Chance de SG</strong> - Defesa s√≥lida contra ataque fraco aumenta probabilidade de clean sheet (+5 pts).`
          );
        }
        if (player.posicao_id === 5 && media > 7) {
          justifications.push(
            `‚öΩ <strong>Alto potencial ofensivo</strong> - Finalizador nato com m√©dia expressiva de gols e assist√™ncias.`
          );
        }
        if (player.posicao_id === 2 && matchInfo?.isHome) {
          justifications.push(
            `üöÄ <strong>Lateral ofensivo em casa</strong> - Tend√™ncia a subir ao ataque e buscar assist√™ncias/desarmes.`
          );
        }

        return justifications;
      }

      async function analyzeTeam() {
        const budget = parseFloat(document.getElementById("budget").value) || 100;
        const rodada = document.getElementById("rodada").value;
        const strategy = document.getElementById("strategy").value;

        document.getElementById("loadingSection").style.display = "block";
        document.getElementById("mainContent").style.display = "none";
        document.getElementById("analyzeBtn").disabled = true;

        // Simulate steps
        const steps = ["step1", "step2", "step3", "step4"];
        for (let i = 0; i < steps.length; i++) {
          await new Promise((r) => setTimeout(r, 600));
          document.querySelectorAll(".step").forEach((s) => s.classList.remove("active"));
          if (document.getElementById(steps[i])) {
            document.getElementById(steps[i]).classList.add("active");
          }
        }

        const success = await fetchData();

        document.getElementById("loadingSection").style.display = "none";
        document.getElementById("analyzeBtn").disabled = false;

        if (!success) {
          alert("Erro ao carregar dados. Tente novamente.");
          return;
        }

        processAnalysis(budget, strategy);
      }

      function processAnalysis(budget, strategy) {
        const atletas = cachedData.atletas;
        const clubes = cachedData.clubes;
        const partidas = cachedData.partidas;

        // Group by position
        const byPosition = {};
        for (let i = 1; i <= 6; i++) {
          byPosition[i] = atletas.filter((a) => a.posicao_id === i && a.status_id === 7);
        }

        // Calculate scores and select best team within budget
        selectedTeam = {};
        let remainingBudget = budget;
        let totalProjected = 0;

        // Process each position in order of priority
        const priority = [1, 3, 5, 4, 2, 6]; // GOL, ZAG, ATA, MEI, LAT, TEC

        priority.forEach((posId) => {
          const players = byPosition[posId] || [];
          const posConfig = FORMATION_433[posId];
          const needed = posConfig.positions.length;

          const scoredPlayers = players
            .map((p) => {
              const matchInfo = getMatchAnalysis(p.clube_id, partidas);
              const aiScore = calculateAIScore(p, matchInfo, strategy);
              return { ...p, matchInfo, aiScore };
            })
            .sort((a, b) => b.aiScore.total - a.aiScore.total);

          // Select best affordable players for this position
          const selected = [];
          let posCount = 0;

          for (let player of scoredPlayers) {
            if (posCount >= needed) break;
            if (player.preco_num <= remainingBudget) {
              selected.push(player);
              remainingBudget -= player.preco_num;
              totalProjected += parseFloat(player.media_num);
              posCount++;
            }
          }

          selectedTeam[posId] = selected;
        });

        displayResults(selectedTeam, remainingBudget, totalProjected);
      }

      function displayResults(team, remaining, projected) {
        document.getElementById("mainContent").style.display = "flex";

        // Display formation
        const formationDiv = document.getElementById("teamFormation");
        formationDiv.innerHTML = ""; // Limpa o conte√∫do existente

        const rows = [
          { pos: 6, label: "T√©cnico" },
          { pos: 5, label: "Atacantes", count: 3 },
          { pos: 4, label: "Meias", count: 3 },
          { pos: 3, label: "Zagueiros", count: 2 },
          { pos: 2, label: "Laterais", count: 2 },
          { pos: 1, label: "Goleiro", count: 1 },
        ];

        rows.forEach((row) => {
          const rowDiv = document.createElement("div");
          rowDiv.className = "position-row";

          const players = team[row.pos] || [];
          players.forEach((player, idx) => {
            const badge =
              player.clube_id && cachedData.clubes[player.clube_id]
                ? cachedData.clubes[player.clube_id].escudos["60x60"]
                : "";
            const clubName =
              player.clube_id && cachedData.clubes[player.clube_id]
                ? cachedData.clubes[player.clube_id].nome
                : "Time";

            const playerDiv = document.createElement("div");
            playerDiv.className = "player-position";

            playerDiv.innerHTML = `
                        <div class="pos-label">${POSITION_NAMES[row.pos]} ${
              players.length > 1 ? idx + 1 : ""
            }</div>
                        <div class="player-badge">
                            ${
                              badge
                                ? `<img src="${badge}" alt="${clubName}">`
                                : '<div style="width:100%;height:100%;background:#ccc;"></div>'
                            }
                        </div>
                        <div class="player-name-field">${player.apelido}</div>
                        <div class="player-team-field">${clubName}</div>
                        <div class="player-price-field">C$ ${player.preco_num.toFixed(2)}</div>
                    `;

            playerDiv.addEventListener("click", () => showJustification(player, playerDiv));

            rowDiv.appendChild(playerDiv);
          });

          formationDiv.appendChild(rowDiv);
        });

        // Display matchups
        const matchupList = document.getElementById("matchupList");
        matchupList.innerHTML = "";

        if (cachedData.partidas && cachedData.partidas.partidas) {
          cachedData.partidas.partidas.forEach((match) => {
            if (!match.valida) return;

            const homeClub = cachedData.clubes[match.clube_casa_id];
            const awayClub = cachedData.clubes[match.clube_visitante_id];

            const homeStrength =
              match.clube_casa_posicao <= 5
                ? "hard"
                : match.clube_casa_posicao >= 15
                ? "easy"
                : "medium";
            const awayStrength =
              match.clube_visitante_posicao <= 5
                ? "hard"
                : match.clube_visitante_posicao >= 15
                ? "easy"
                : "medium";

            const matchupDiv = document.createElement("div");
            matchupDiv.className = "matchup-item";
            matchupDiv.innerHTML = `
                        <div class="matchup-teams">
                            <div class="matchup-team">
                                <img src="${homeClub?.escudos["30x30"] || ""}" alt="${homeClub?.nome}">
                                <span>${homeClub?.abreviacao || "CASA"}</span>
                            </div>
                            <span class="vs">VS</span>
                            <div class="matchup-team">
                                <img src="${awayClub?.escudos["30x30"] || ""}" alt="${awayClub?.nome}">
                                <span>${awayClub?.abreviacao || "FORA"}</span>
                            </div>
                        </div>
                        <div style="display:flex;gap:5px;">
                            <span class="matchup-difficulty difficulty-${homeStrength}">${
              match.clube_casa_posicao
            }¬∫</span>
                            <span class="matchup-difficulty difficulty-${awayStrength}">${
              match.clube_visitante_posicao
            }¬∫</span>
                        </div>
                    `;
            matchupList.appendChild(matchupDiv);
          });
        }

        // Update summary
        const totalCost = Object.values(team).flat().reduce((sum, p) => sum + p.preco_num, 0);
        const avgCB = projected / (totalCost || 1);

        document.getElementById("totalCost").textContent = `C$ ${totalCost.toFixed(2)}`;
        document.getElementById("remainingBudget").textContent = `C$ ${remaining.toFixed(2)}`;
        document.getElementById("projectedPoints").textContent = projected.toFixed(2);
        document.getElementById("avgCostBenefit").textContent = avgCB.toFixed(2);

        // Tactical analysis
        const tacticalText = generateTacticalAnalysis(team, cachedData.partidas);
        document.getElementById("tacticalAnalysis").innerHTML = tacticalText;

        // Show first player justification by default
        const firstPlayer = Object.values(team).flat()[0];
        if (firstPlayer) {
          const firstPlayerDiv = document.querySelector(".player-position"); // Pega o primeiro elemento de jogador
          showJustification(firstPlayer, firstPlayerDiv);
        }
      }

      function generateTacticalAnalysis(team, partidas) {
        let analysis = "<strong>An√°lise T√°tica 4-3-3:</strong><br><br>";

        // Count home/away
        let homeCount = 0;
        let easyMatches = 0;

        Object.values(team).flat().forEach((p) => {
          if (p.matchInfo) {
            if (p.matchInfo.isHome) homeCount++;
            if (p.matchInfo.difficulty === "F√°cil") easyMatches++;
          }
        });

        analysis += `‚Ä¢ <strong>${homeCount} jogadores</strong> atuam em casa, favorecendo desempenho.<br>`;
        analysis += `‚Ä¢ <strong>${easyMatches} confrontos f√°ceis</strong> identificados pela IA para maximizar pontua√ß√£o.<br>`;

        // Defense analysis
        const gk = team[1]?.[0];
        const defs = [...(team[2] || []), ...(team[3] || [])];
        if (gk && gk.matchInfo?.difficulty === "F√°cil") {
          analysis += `‚Ä¢ <strong>Defesa s√≥lida:</strong> Goleiro com chance alta de SG (Clean Sheet).<br>`;
        }

        // Attack analysis
        const atacantes = team[5] || [];
        const topScorer = atacantes.sort((a, b) => b.media_num - a.media_num)[0];
        if (topScorer) {
          analysis += `‚Ä¢ <strong>Ataque potente:</strong> ${topScorer.apelido} √© o principal finalizador com m√©dia de ${topScorer.media_num} pts.<br>`;
        }

        analysis += `<br><em>Time montado com estrat√©gia otimizada para pontuar dentro do or√ßamento dispon√≠vel.</em>`;

        return analysis;
      }

      function showJustification(player, clickedElement) {
        const container = document.getElementById("justificationContent");
        container.innerHTML = "";

        const card = document.createElement("div");
        card.className = "justification-card active";

        const justifications = generateJustification(
          player,
          player.matchInfo,
          player.aiScore,
          document.getElementById("strategy").value
        );
        const club = cachedData.clubes[player.clube_id];

        card.innerHTML = `
                <div class="justification-header">
                    <img src="${club?.escudos["60x60"] || ""}" alt="${club?.nome}">
                    <div>
                        <div class="justification-title">${player.apelido}</div>
                        <div style="color:#aaa;font-size:0.9em;">${POSITION_NAMES[player.posicao_id]} - ${
          club?.nome || "Time"
        }</div>
                    </div>
                </div>

                <div class="justification-text">
                    ${justifications.map((j) => `<p style="margin-bottom:10px;">${j}</p>`).join("")}
                </div>

                <div class="ai-reasoning">
                    <div class="ai-reasoning-title">ü§ñ Score IA: ${player.aiScore.total.toFixed(1)} pts</div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value">${player.media_num}</div>
                            <div class="stat-label">M√©dia</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">C$ ${player.preco_num.toFixed(2)}</div>
                            <div class="stat-label">Pre√ßo</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${player.jogos_num}</div>
                            <div class="stat-label">Jogos</div>
                        </div>
                    </div>
                </div>
            `;

        container.appendChild(card);

        // Highlight selected player on field
        document.querySelectorAll(".player-position").forEach((el) => el.classList.remove("selected"));
        if (clickedElement) {
          clickedElement.classList.add("selected");
        }
      }

      // Adiciona o event listener para o bot√£o 'analyzeBtn'
      document.addEventListener("DOMContentLoaded", () => {
        const analyzeBtn = document.getElementById("analyzeBtn");

        if (analyzeBtn) {
          analyzeBtn.addEventListener("click", analyzeTeam);
          console.log("Event listener adicionado ao bot√£o 'MONTAR TIME COM IA'.");
        } else {
          console.error("Bot√£o com ID 'analyzeBtn' n√£o encontrado!");
        }
      });

      // Initialize - Removido fetchData() daqui para evitar que ele rode no carregamento da p√°gina
      // e para garantir que s√≥ rode ao clicar no bot√£o.
      // Se voc√™ quer que ele carregue dados ao iniciar, pode chamar analyzeTeam() aqui,
      // mas o ideal √© que o usu√°rio clique no bot√£o.
      window.onload = () => {
        // Opcional: Se quiser carregar dados mock ou uma an√°lise inicial ao carregar a p√°gina
        // sem o clique do usu√°rio, voc√™ pode chamar uma fun√ß√£o aqui.
        // Por exemplo, para mostrar a interface com dados mock iniciais:
        // processAnalysis(100, 'balanced');
      };
    </script>
  </body>
</html>
